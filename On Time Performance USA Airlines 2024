{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/fiftythirtyfour/usa-airlines-delays-2024?scriptVersionId=240510978\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"code","execution_count":1,"id":"9b33fa0b","metadata":{"_cell_guid":"b1076dfc-b9ad-4769-8c92-a6c4dae69d19","_uuid":"8f2839f25d086af736a60e9eeb907d3b93b6e0e5","execution":{"iopub.execute_input":"2025-05-19T01:34:52.788434Z","iopub.status.busy":"2025-05-19T01:34:52.788135Z","iopub.status.idle":"2025-05-19T01:34:56.832078Z","shell.execute_reply":"2025-05-19T01:34:56.83095Z"},"papermill":{"duration":4.050911,"end_time":"2025-05-19T01:34:56.834007","exception":false,"start_time":"2025-05-19T01:34:52.783096","status":"completed"},"tags":[]},"outputs":[],"source":["import pandas as pd\n","import numpy as np\n","import seaborn as sns\n","import warnings\n","import glob\n","from zoneinfo import ZoneInfo\n","warnings.filterwarnings('ignore')\n","pd.options.display.max_rows = 1500\n","pd.options.display.max_columns = 500"]},{"cell_type":"code","execution_count":2,"id":"8ed4b394","metadata":{"execution":{"iopub.execute_input":"2025-05-19T01:34:56.842412Z","iopub.status.busy":"2025-05-19T01:34:56.841937Z","iopub.status.idle":"2025-05-19T01:34:56.939348Z","shell.execute_reply":"2025-05-19T01:34:56.938309Z"},"papermill":{"duration":0.103293,"end_time":"2025-05-19T01:34:56.941098","exception":false,"start_time":"2025-05-19T01:34:56.837805","status":"completed"},"tags":[]},"outputs":[],"source":["openflights = pd.read_csv('/kaggle/input/usa-airline-2024/airports.csv')\n","unique_carrier = pd.read_csv('/kaggle/input/usa-airline-2024/L_UNIQUE_CARRIERS.csv'\n","                             , header=None, names=[\"code\", \"airline_name\"])\n","csv_files = glob.glob('/kaggle/input/usa-airline-2024/T_ONTIME_REPORTING/*.csv', recursive=True)"]},{"cell_type":"code","execution_count":3,"id":"16ae25ea","metadata":{"execution":{"iopub.execute_input":"2025-05-19T01:34:56.948787Z","iopub.status.busy":"2025-05-19T01:34:56.948438Z","iopub.status.idle":"2025-05-19T01:37:27.072232Z","shell.execute_reply":"2025-05-19T01:37:27.070854Z"},"papermill":{"duration":150.132178,"end_time":"2025-05-19T01:37:27.076614","exception":false,"start_time":"2025-05-19T01:34:56.944436","status":"completed"},"tags":[]},"outputs":[],"source":["df = pd.concat([pd.read_csv(x) for x in csv_files])\n","df = df.drop_duplicates()\n","df.columns = df.columns.str.lower()\n","\n","df['otp_dep_15'] = np.where(df['dep_del15'] == 1, 0 , 1)\n","df['flight_number'] = df['op_unique_carrier'] + df['op_carrier_fl_num'].fillna('0').astype(int).astype(str).str.zfill(4)\n","df['std_ls_date'] = pd.to_datetime(df['fl_date'])"]},{"cell_type":"code","execution_count":4,"id":"cfadc49a","metadata":{"execution":{"iopub.execute_input":"2025-05-19T01:37:27.088821Z","iopub.status.busy":"2025-05-19T01:37:27.088035Z","iopub.status.idle":"2025-05-19T01:37:28.144848Z","shell.execute_reply":"2025-05-19T01:37:28.143799Z"},"papermill":{"duration":1.063943,"end_time":"2025-05-19T01:37:28.146957","exception":false,"start_time":"2025-05-19T01:37:27.083014","status":"completed"},"tags":[]},"outputs":[],"source":["df = df.query('std_ls_date <= \"2024-01-10\"').copy()"]},{"cell_type":"code","execution_count":5,"id":"9d3b700e","metadata":{"execution":{"iopub.execute_input":"2025-05-19T01:37:28.155594Z","iopub.status.busy":"2025-05-19T01:37:28.155129Z","iopub.status.idle":"2025-05-19T01:37:28.620202Z","shell.execute_reply":"2025-05-19T01:37:28.619126Z"},"papermill":{"duration":0.471662,"end_time":"2025-05-19T01:37:28.622019","exception":false,"start_time":"2025-05-19T01:37:28.150357","status":"completed"},"tags":[]},"outputs":[],"source":["df = df.merge(openflights, how='left', left_on='origin', right_on='iata')\n","df = df.merge(unique_carrier, how='left', left_on='op_unique_carrier', right_on='code')"]},{"cell_type":"code","execution_count":6,"id":"0c4c29da","metadata":{"execution":{"iopub.execute_input":"2025-05-19T01:37:28.630572Z","iopub.status.busy":"2025-05-19T01:37:28.629368Z","iopub.status.idle":"2025-05-19T01:37:28.698938Z","shell.execute_reply":"2025-05-19T01:37:28.697922Z"},"papermill":{"duration":0.077252,"end_time":"2025-05-19T01:37:28.702629","exception":false,"start_time":"2025-05-19T01:37:28.625377","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>year</th>\n","      <th>quarter</th>\n","      <th>month</th>\n","      <th>day_of_month</th>\n","      <th>day_of_week</th>\n","      <th>fl_date</th>\n","      <th>op_unique_carrier</th>\n","      <th>op_carrier_airline_id</th>\n","      <th>op_carrier</th>\n","      <th>tail_num</th>\n","      <th>op_carrier_fl_num</th>\n","      <th>origin_airport_id</th>\n","      <th>origin_airport_seq_id</th>\n","      <th>origin_city_market_id</th>\n","      <th>origin</th>\n","      <th>origin_city_name</th>\n","      <th>origin_state_abr</th>\n","      <th>origin_state_fips</th>\n","      <th>origin_state_nm</th>\n","      <th>origin_wac</th>\n","      <th>dest_airport_id</th>\n","      <th>dest_airport_seq_id</th>\n","      <th>dest_city_market_id</th>\n","      <th>dest</th>\n","      <th>dest_city_name</th>\n","      <th>dest_state_abr</th>\n","      <th>dest_state_fips</th>\n","      <th>dest_state_nm</th>\n","      <th>dest_wac</th>\n","      <th>crs_dep_time</th>\n","      <th>dep_time</th>\n","      <th>dep_delay</th>\n","      <th>dep_delay_new</th>\n","      <th>dep_del15</th>\n","      <th>dep_delay_group</th>\n","      <th>dep_time_blk</th>\n","      <th>taxi_out</th>\n","      <th>wheels_off</th>\n","      <th>wheels_on</th>\n","      <th>taxi_in</th>\n","      <th>crs_arr_time</th>\n","      <th>arr_time</th>\n","      <th>arr_delay</th>\n","      <th>arr_delay_new</th>\n","      <th>arr_del15</th>\n","      <th>arr_delay_group</th>\n","      <th>arr_time_blk</th>\n","      <th>cancelled</th>\n","      <th>cancellation_code</th>\n","      <th>diverted</th>\n","      <th>crs_elapsed_time</th>\n","      <th>actual_elapsed_time</th>\n","      <th>air_time</th>\n","      <th>flights</th>\n","      <th>distance</th>\n","      <th>distance_group</th>\n","      <th>carrier_delay</th>\n","      <th>weather_delay</th>\n","      <th>nas_delay</th>\n","      <th>security_delay</th>\n","      <th>late_aircraft_delay</th>\n","      <th>first_dep_time</th>\n","      <th>total_add_gtime</th>\n","      <th>longest_add_gtime</th>\n","      <th>div_airport_landings</th>\n","      <th>div_reached_dest</th>\n","      <th>div_actual_elapsed_time</th>\n","      <th>div_arr_delay</th>\n","      <th>div_distance</th>\n","      <th>div1_airport</th>\n","      <th>div1_airport_id</th>\n","      <th>div1_airport_seq_id</th>\n","      <th>div1_wheels_on</th>\n","      <th>div1_total_gtime</th>\n","      <th>div1_longest_gtime</th>\n","      <th>div1_wheels_off</th>\n","      <th>div1_tail_num</th>\n","      <th>otp_dep_15</th>\n","      <th>flight_number</th>\n","      <th>std_ls_date</th>\n","      <th>id</th>\n","      <th>name</th>\n","      <th>city</th>\n","      <th>country</th>\n","      <th>iata</th>\n","      <th>icao</th>\n","      <th>lat</th>\n","      <th>long</th>\n","      <th>altitude</th>\n","      <th>utc_offset</th>\n","      <th>dst</th>\n","      <th>timezone</th>\n","      <th>type</th>\n","      <th>source</th>\n","      <th>code</th>\n","      <th>airline_name</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>2024</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1/1/2024 12:00:00 AM</td>\n","      <td>9E</td>\n","      <td>20363</td>\n","      <td>9E</td>\n","      <td>N131EV</td>\n","      <td>5225.0</td>\n","      <td>10397</td>\n","      <td>1039707</td>\n","      <td>30397</td>\n","      <td>ATL</td>\n","      <td>Atlanta, GA</td>\n","      <td>GA</td>\n","      <td>13</td>\n","      <td>Georgia</td>\n","      <td>34</td>\n","      <td>10431</td>\n","      <td>1043106</td>\n","      <td>30431</td>\n","      <td>AVL</td>\n","      <td>Asheville, NC</td>\n","      <td>NC</td>\n","      <td>37</td>\n","      <td>North Carolina</td>\n","      <td>36</td>\n","      <td>1410</td>\n","      <td>1406.0</td>\n","      <td>-4.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>-1.0</td>\n","      <td>1400-1459</td>\n","      <td>10.0</td>\n","      <td>1416.0</td>\n","      <td>1449.0</td>\n","      <td>5.0</td>\n","      <td>1511</td>\n","      <td>1454.0</td>\n","      <td>-17.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>-2.0</td>\n","      <td>1500-1559</td>\n","      <td>0.0</td>\n","      <td>NaN</td>\n","      <td>0.0</td>\n","      <td>61.0</td>\n","      <td>48.0</td>\n","      <td>33.0</td>\n","      <td>1.0</td>\n","      <td>164.0</td>\n","      <td>1</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>0.0</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>1</td>\n","      <td>9E5225</td>\n","      <td>2024-01-01</td>\n","      <td>3682.0</td>\n","      <td>Hartsfield Jackson Atlanta International Airport</td>\n","      <td>Atlanta</td>\n","      <td>United States</td>\n","      <td>ATL</td>\n","      <td>KATL</td>\n","      <td>33.636700</td>\n","      <td>-84.428101</td>\n","      <td>1026.0</td>\n","      <td>-5</td>\n","      <td>A</td>\n","      <td>America/New_York</td>\n","      <td>airport</td>\n","      <td>OurAirports</td>\n","      <td>9E</td>\n","      <td>Endeavor Air Inc.</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2024</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1/1/2024 12:00:00 AM</td>\n","      <td>9E</td>\n","      <td>20363</td>\n","      <td>9E</td>\n","      <td>N132EV</td>\n","      <td>5115.0</td>\n","      <td>11433</td>\n","      <td>1143302</td>\n","      <td>31295</td>\n","      <td>DTW</td>\n","      <td>Detroit, MI</td>\n","      <td>MI</td>\n","      <td>26</td>\n","      <td>Michigan</td>\n","      <td>43</td>\n","      <td>13871</td>\n","      <td>1387102</td>\n","      <td>33316</td>\n","      <td>OMA</td>\n","      <td>Omaha, NE</td>\n","      <td>NE</td>\n","      <td>31</td>\n","      <td>Nebraska</td>\n","      <td>65</td>\n","      <td>1545</td>\n","      <td>1541.0</td>\n","      <td>-4.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>-1.0</td>\n","      <td>1500-1559</td>\n","      <td>14.0</td>\n","      <td>1555.0</td>\n","      <td>1624.0</td>\n","      <td>3.0</td>\n","      <td>1700</td>\n","      <td>1627.0</td>\n","      <td>-33.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>-2.0</td>\n","      <td>1700-1759</td>\n","      <td>0.0</td>\n","      <td>NaN</td>\n","      <td>0.0</td>\n","      <td>135.0</td>\n","      <td>106.0</td>\n","      <td>89.0</td>\n","      <td>1.0</td>\n","      <td>651.0</td>\n","      <td>3</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>0.0</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>1</td>\n","      <td>9E5115</td>\n","      <td>2024-01-01</td>\n","      <td>3645.0</td>\n","      <td>Detroit Metropolitan Wayne County Airport</td>\n","      <td>Detroit</td>\n","      <td>United States</td>\n","      <td>DTW</td>\n","      <td>KDTW</td>\n","      <td>42.212399</td>\n","      <td>-83.353401</td>\n","      <td>645.0</td>\n","      <td>-5</td>\n","      <td>A</td>\n","      <td>America/New_York</td>\n","      <td>airport</td>\n","      <td>OurAirports</td>\n","      <td>9E</td>\n","      <td>Endeavor Air Inc.</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2024</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1/1/2024 12:00:00 AM</td>\n","      <td>9E</td>\n","      <td>20363</td>\n","      <td>9E</td>\n","      <td>N132EV</td>\n","      <td>5414.0</td>\n","      <td>11423</td>\n","      <td>1142308</td>\n","      <td>31423</td>\n","      <td>DSM</td>\n","      <td>Des Moines, IA</td>\n","      <td>IA</td>\n","      <td>19</td>\n","      <td>Iowa</td>\n","      <td>61</td>\n","      <td>11433</td>\n","      <td>1143302</td>\n","      <td>31295</td>\n","      <td>DTW</td>\n","      <td>Detroit, MI</td>\n","      <td>MI</td>\n","      <td>26</td>\n","      <td>Michigan</td>\n","      <td>43</td>\n","      <td>626</td>\n","      <td>621.0</td>\n","      <td>-5.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>-1.0</td>\n","      <td>0600-0659</td>\n","      <td>12.0</td>\n","      <td>633.0</td>\n","      <td>900.0</td>\n","      <td>9.0</td>\n","      <td>917</td>\n","      <td>909.0</td>\n","      <td>-8.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>-1.0</td>\n","      <td>0900-0959</td>\n","      <td>0.0</td>\n","      <td>NaN</td>\n","      <td>0.0</td>\n","      <td>111.0</td>\n","      <td>108.0</td>\n","      <td>87.0</td>\n","      <td>1.0</td>\n","      <td>533.0</td>\n","      <td>3</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>0.0</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>1</td>\n","      <td>9E5414</td>\n","      <td>2024-01-01</td>\n","      <td>3729.0</td>\n","      <td>Des Moines International Airport</td>\n","      <td>Des Moines</td>\n","      <td>United States</td>\n","      <td>DSM</td>\n","      <td>KDSM</td>\n","      <td>41.534000</td>\n","      <td>-93.663101</td>\n","      <td>958.0</td>\n","      <td>-6</td>\n","      <td>A</td>\n","      <td>America/Chicago</td>\n","      <td>airport</td>\n","      <td>OurAirports</td>\n","      <td>9E</td>\n","      <td>Endeavor Air Inc.</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>2024</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1/1/2024 12:00:00 AM</td>\n","      <td>9E</td>\n","      <td>20363</td>\n","      <td>9E</td>\n","      <td>N133EV</td>\n","      <td>5284.0</td>\n","      <td>12953</td>\n","      <td>1295304</td>\n","      <td>31703</td>\n","      <td>LGA</td>\n","      <td>New York, NY</td>\n","      <td>NY</td>\n","      <td>36</td>\n","      <td>New York</td>\n","      <td>22</td>\n","      <td>14685</td>\n","      <td>1468502</td>\n","      <td>34685</td>\n","      <td>SAV</td>\n","      <td>Savannah, GA</td>\n","      <td>GA</td>\n","      <td>13</td>\n","      <td>Georgia</td>\n","      <td>34</td>\n","      <td>1815</td>\n","      <td>1810.0</td>\n","      <td>-5.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>-1.0</td>\n","      <td>1800-1859</td>\n","      <td>21.0</td>\n","      <td>1831.0</td>\n","      <td>2014.0</td>\n","      <td>5.0</td>\n","      <td>2045</td>\n","      <td>2019.0</td>\n","      <td>-26.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>-2.0</td>\n","      <td>2000-2059</td>\n","      <td>0.0</td>\n","      <td>NaN</td>\n","      <td>0.0</td>\n","      <td>150.0</td>\n","      <td>129.0</td>\n","      <td>103.0</td>\n","      <td>1.0</td>\n","      <td>722.0</td>\n","      <td>3</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>0.0</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>1</td>\n","      <td>9E5284</td>\n","      <td>2024-01-01</td>\n","      <td>3697.0</td>\n","      <td>La Guardia Airport</td>\n","      <td>New York</td>\n","      <td>United States</td>\n","      <td>LGA</td>\n","      <td>KLGA</td>\n","      <td>40.777199</td>\n","      <td>-73.872597</td>\n","      <td>21.0</td>\n","      <td>-5</td>\n","      <td>A</td>\n","      <td>America/New_York</td>\n","      <td>airport</td>\n","      <td>OurAirports</td>\n","      <td>9E</td>\n","      <td>Endeavor Air Inc.</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>2024</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1/1/2024 12:00:00 AM</td>\n","      <td>9E</td>\n","      <td>20363</td>\n","      <td>9E</td>\n","      <td>N133EV</td>\n","      <td>5341.0</td>\n","      <td>10994</td>\n","      <td>1099402</td>\n","      <td>30994</td>\n","      <td>CHS</td>\n","      <td>Charleston, SC</td>\n","      <td>SC</td>\n","      <td>45</td>\n","      <td>South Carolina</td>\n","      <td>37</td>\n","      <td>12953</td>\n","      <td>1295304</td>\n","      <td>31703</td>\n","      <td>LGA</td>\n","      <td>New York, NY</td>\n","      <td>NY</td>\n","      <td>36</td>\n","      <td>New York</td>\n","      <td>22</td>\n","      <td>830</td>\n","      <td>823.0</td>\n","      <td>-7.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>-1.0</td>\n","      <td>0800-0859</td>\n","      <td>12.0</td>\n","      <td>835.0</td>\n","      <td>958.0</td>\n","      <td>9.0</td>\n","      <td>1028</td>\n","      <td>1007.0</td>\n","      <td>-21.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>-2.0</td>\n","      <td>1000-1059</td>\n","      <td>0.0</td>\n","      <td>NaN</td>\n","      <td>0.0</td>\n","      <td>118.0</td>\n","      <td>104.0</td>\n","      <td>83.0</td>\n","      <td>1.0</td>\n","      <td>641.0</td>\n","      <td>3</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>0.0</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>1</td>\n","      <td>9E5341</td>\n","      <td>2024-01-01</td>\n","      <td>3806.0</td>\n","      <td>Charleston Air Force Base-International Airport</td>\n","      <td>Charleston</td>\n","      <td>United States</td>\n","      <td>CHS</td>\n","      <td>KCHS</td>\n","      <td>32.898602</td>\n","      <td>-80.040497</td>\n","      <td>46.0</td>\n","      <td>-5</td>\n","      <td>A</td>\n","      <td>America/New_York</td>\n","      <td>airport</td>\n","      <td>OurAirports</td>\n","      <td>9E</td>\n","      <td>Endeavor Air Inc.</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["   year  quarter  month  day_of_month  day_of_week               fl_date  \\\n","0  2024        1      1             1            1  1/1/2024 12:00:00 AM   \n","1  2024        1      1             1            1  1/1/2024 12:00:00 AM   \n","2  2024        1      1             1            1  1/1/2024 12:00:00 AM   \n","3  2024        1      1             1            1  1/1/2024 12:00:00 AM   \n","4  2024        1      1             1            1  1/1/2024 12:00:00 AM   \n","\n","  op_unique_carrier  op_carrier_airline_id op_carrier tail_num  \\\n","0                9E                  20363         9E   N131EV   \n","1                9E                  20363         9E   N132EV   \n","2                9E                  20363         9E   N132EV   \n","3                9E                  20363         9E   N133EV   \n","4                9E                  20363         9E   N133EV   \n","\n","   op_carrier_fl_num  origin_airport_id  origin_airport_seq_id  \\\n","0             5225.0              10397                1039707   \n","1             5115.0              11433                1143302   \n","2             5414.0              11423                1142308   \n","3             5284.0              12953                1295304   \n","4             5341.0              10994                1099402   \n","\n","   origin_city_market_id origin origin_city_name origin_state_abr  \\\n","0                  30397    ATL      Atlanta, GA               GA   \n","1                  31295    DTW      Detroit, MI               MI   \n","2                  31423    DSM   Des Moines, IA               IA   \n","3                  31703    LGA     New York, NY               NY   \n","4                  30994    CHS   Charleston, SC               SC   \n","\n","   origin_state_fips origin_state_nm  origin_wac  dest_airport_id  \\\n","0                 13         Georgia          34            10431   \n","1                 26        Michigan          43            13871   \n","2                 19            Iowa          61            11433   \n","3                 36        New York          22            14685   \n","4                 45  South Carolina          37            12953   \n","\n","   dest_airport_seq_id  dest_city_market_id dest dest_city_name  \\\n","0              1043106                30431  AVL  Asheville, NC   \n","1              1387102                33316  OMA      Omaha, NE   \n","2              1143302                31295  DTW    Detroit, MI   \n","3              1468502                34685  SAV   Savannah, GA   \n","4              1295304                31703  LGA   New York, NY   \n","\n","  dest_state_abr  dest_state_fips   dest_state_nm  dest_wac  crs_dep_time  \\\n","0             NC               37  North Carolina        36          1410   \n","1             NE               31        Nebraska        65          1545   \n","2             MI               26        Michigan        43           626   \n","3             GA               13         Georgia        34          1815   \n","4             NY               36        New York        22           830   \n","\n","   dep_time  dep_delay  dep_delay_new  dep_del15  dep_delay_group  \\\n","0    1406.0       -4.0            0.0        0.0             -1.0   \n","1    1541.0       -4.0            0.0        0.0             -1.0   \n","2     621.0       -5.0            0.0        0.0             -1.0   \n","3    1810.0       -5.0            0.0        0.0             -1.0   \n","4     823.0       -7.0            0.0        0.0             -1.0   \n","\n","  dep_time_blk  taxi_out  wheels_off  wheels_on  taxi_in  crs_arr_time  \\\n","0    1400-1459      10.0      1416.0     1449.0      5.0          1511   \n","1    1500-1559      14.0      1555.0     1624.0      3.0          1700   \n","2    0600-0659      12.0       633.0      900.0      9.0           917   \n","3    1800-1859      21.0      1831.0     2014.0      5.0          2045   \n","4    0800-0859      12.0       835.0      958.0      9.0          1028   \n","\n","   arr_time  arr_delay  arr_delay_new  arr_del15  arr_delay_group  \\\n","0    1454.0      -17.0            0.0        0.0             -2.0   \n","1    1627.0      -33.0            0.0        0.0             -2.0   \n","2     909.0       -8.0            0.0        0.0             -1.0   \n","3    2019.0      -26.0            0.0        0.0             -2.0   \n","4    1007.0      -21.0            0.0        0.0             -2.0   \n","\n","  arr_time_blk  cancelled cancellation_code  diverted  crs_elapsed_time  \\\n","0    1500-1559        0.0               NaN       0.0              61.0   \n","1    1700-1759        0.0               NaN       0.0             135.0   \n","2    0900-0959        0.0               NaN       0.0             111.0   \n","3    2000-2059        0.0               NaN       0.0             150.0   \n","4    1000-1059        0.0               NaN       0.0             118.0   \n","\n","   actual_elapsed_time  air_time  flights  distance  distance_group  \\\n","0                 48.0      33.0      1.0     164.0               1   \n","1                106.0      89.0      1.0     651.0               3   \n","2                108.0      87.0      1.0     533.0               3   \n","3                129.0     103.0      1.0     722.0               3   \n","4                104.0      83.0      1.0     641.0               3   \n","\n","   carrier_delay  weather_delay  nas_delay  security_delay  \\\n","0            NaN            NaN        NaN             NaN   \n","1            NaN            NaN        NaN             NaN   \n","2            NaN            NaN        NaN             NaN   \n","3            NaN            NaN        NaN             NaN   \n","4            NaN            NaN        NaN             NaN   \n","\n","   late_aircraft_delay  first_dep_time  total_add_gtime  longest_add_gtime  \\\n","0                  NaN             NaN              NaN                NaN   \n","1                  NaN             NaN              NaN                NaN   \n","2                  NaN             NaN              NaN                NaN   \n","3                  NaN             NaN              NaN                NaN   \n","4                  NaN             NaN              NaN                NaN   \n","\n","   div_airport_landings  div_reached_dest  div_actual_elapsed_time  \\\n","0                   0.0               NaN                      NaN   \n","1                   0.0               NaN                      NaN   \n","2                   0.0               NaN                      NaN   \n","3                   0.0               NaN                      NaN   \n","4                   0.0               NaN                      NaN   \n","\n","   div_arr_delay  div_distance div1_airport  div1_airport_id  \\\n","0            NaN           NaN          NaN              NaN   \n","1            NaN           NaN          NaN              NaN   \n","2            NaN           NaN          NaN              NaN   \n","3            NaN           NaN          NaN              NaN   \n","4            NaN           NaN          NaN              NaN   \n","\n","   div1_airport_seq_id  div1_wheels_on  div1_total_gtime  div1_longest_gtime  \\\n","0                  NaN             NaN               NaN                 NaN   \n","1                  NaN             NaN               NaN                 NaN   \n","2                  NaN             NaN               NaN                 NaN   \n","3                  NaN             NaN               NaN                 NaN   \n","4                  NaN             NaN               NaN                 NaN   \n","\n","   div1_wheels_off div1_tail_num  otp_dep_15 flight_number std_ls_date  \\\n","0              NaN           NaN           1        9E5225  2024-01-01   \n","1              NaN           NaN           1        9E5115  2024-01-01   \n","2              NaN           NaN           1        9E5414  2024-01-01   \n","3              NaN           NaN           1        9E5284  2024-01-01   \n","4              NaN           NaN           1        9E5341  2024-01-01   \n","\n","       id                                              name        city  \\\n","0  3682.0  Hartsfield Jackson Atlanta International Airport     Atlanta   \n","1  3645.0         Detroit Metropolitan Wayne County Airport     Detroit   \n","2  3729.0                  Des Moines International Airport  Des Moines   \n","3  3697.0                                La Guardia Airport    New York   \n","4  3806.0   Charleston Air Force Base-International Airport  Charleston   \n","\n","         country iata  icao        lat       long  altitude utc_offset dst  \\\n","0  United States  ATL  KATL  33.636700 -84.428101    1026.0         -5   A   \n","1  United States  DTW  KDTW  42.212399 -83.353401     645.0         -5   A   \n","2  United States  DSM  KDSM  41.534000 -93.663101     958.0         -6   A   \n","3  United States  LGA  KLGA  40.777199 -73.872597      21.0         -5   A   \n","4  United States  CHS  KCHS  32.898602 -80.040497      46.0         -5   A   \n","\n","           timezone     type      source  code       airline_name  \n","0  America/New_York  airport  OurAirports   9E  Endeavor Air Inc.  \n","1  America/New_York  airport  OurAirports   9E  Endeavor Air Inc.  \n","2   America/Chicago  airport  OurAirports   9E  Endeavor Air Inc.  \n","3  America/New_York  airport  OurAirports   9E  Endeavor Air Inc.  \n","4  America/New_York  airport  OurAirports   9E  Endeavor Air Inc.  "]},"execution_count":6,"metadata":{},"output_type":"execute_result"}],"source":["df.head()"]},{"cell_type":"code","execution_count":7,"id":"082432f2","metadata":{"execution":{"iopub.execute_input":"2025-05-19T01:37:28.712215Z","iopub.status.busy":"2025-05-19T01:37:28.711893Z","iopub.status.idle":"2025-05-19T01:37:28.717172Z","shell.execute_reply":"2025-05-19T01:37:28.716277Z"},"papermill":{"duration":0.011868,"end_time":"2025-05-19T01:37:28.718743","exception":false,"start_time":"2025-05-19T01:37:28.706875","status":"completed"},"tags":[]},"outputs":[],"source":["def convert_to_utc(local_dt, timezone):\n","    try:\n","        return local_dt.replace(tzinfo=ZoneInfo(timezone)).astimezone(ZoneInfo(\"UTC\"))\n","    except:\n","        return pd.NaT"]},{"cell_type":"code","execution_count":8,"id":"2fb85049","metadata":{"execution":{"iopub.execute_input":"2025-05-19T01:37:28.728147Z","iopub.status.busy":"2025-05-19T01:37:28.727343Z","iopub.status.idle":"2025-05-19T01:37:35.345415Z","shell.execute_reply":"2025-05-19T01:37:35.344556Z"},"papermill":{"duration":6.624538,"end_time":"2025-05-19T01:37:35.347312","exception":false,"start_time":"2025-05-19T01:37:28.722774","status":"completed"},"tags":[]},"outputs":[],"source":["## Time\n","df['std_ls_time'] = df['crs_dep_time'].replace(2400, 0).astype(str).str.zfill(4)\n","df['atd_ls_time'] = df['dep_time'].fillna(0).replace(2400, 0).astype(int).astype(str).str.zfill(4)\n","df['sta_ls_time'] = df['crs_arr_time'].replace(2400, 0).astype(str).str.zfill(4)\n","df['ata_ls_time'] = df['arr_time'].fillna(0).replace(2400, 0).astype(int).astype(str).str.zfill(4)\n","\n","## Departure Datetime\n","df['std_ls_date_time'] = pd.to_datetime(df['std_ls_date'].dt.strftime('%Y-%m-%d') + ' ' + df['std_ls_time'].str[:2] + ':' + df['std_ls_time'].str[2:])\n","df['atd_ls_date_time'] = df['std_ls_date_time'] + pd.to_timedelta(df['dep_delay'], unit='m')\n","\n","## UTC\n","df['std_z_date_time'] = df.apply(lambda x: convert_to_utc(x['std_ls_date_time'], x['timezone']), axis=1)\n","df['atd_z_date_time'] = df['std_z_date_time'] + pd.to_timedelta(df['dep_delay'], unit='m')\n","df['sta_z_date_time'] = df['std_z_date_time'] + pd.to_timedelta(df['crs_elapsed_time'], unit='m')\n","df['ata_z_date_time'] = df['atd_z_date_time'] + pd.to_timedelta(df['actual_elapsed_time'], unit='m')"]},{"cell_type":"code","execution_count":9,"id":"26630560","metadata":{"execution":{"iopub.execute_input":"2025-05-19T01:37:35.358776Z","iopub.status.busy":"2025-05-19T01:37:35.358415Z","iopub.status.idle":"2025-05-19T01:37:36.116343Z","shell.execute_reply":"2025-05-19T01:37:36.115186Z"},"papermill":{"duration":0.765826,"end_time":"2025-05-19T01:37:36.11821","exception":false,"start_time":"2025-05-19T01:37:35.352384","status":"completed"},"tags":[]},"outputs":[],"source":["num = df.select_dtypes(include='number').columns.to_list()\n","cat = df.select_dtypes(include='object').columns.to_list()\n","\n","target = 'otp_dep_15'\n","num.remove(target)\n","num.remove('dep_del15')\n","\n","from sklearn.model_selection import train_test_split\n","train, test = train_test_split(df, test_size=.2)"]},{"cell_type":"markdown","id":"534d1f0c","metadata":{"papermill":{"duration":0.004147,"end_time":"2025-05-19T01:37:36.126529","exception":false,"start_time":"2025-05-19T01:37:36.122382","status":"completed"},"tags":[]},"source":["# Data Science"]},{"cell_type":"code","execution_count":10,"id":"dcebfa1a","metadata":{"execution":{"iopub.execute_input":"2025-05-19T01:37:36.13552Z","iopub.status.busy":"2025-05-19T01:37:36.135167Z","iopub.status.idle":"2025-05-19T01:37:36.16952Z","shell.execute_reply":"2025-05-19T01:37:36.168274Z"},"papermill":{"duration":0.040924,"end_time":"2025-05-19T01:37:36.17127","exception":false,"start_time":"2025-05-19T01:37:36.130346","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>airline_name</th>\n","      <th>count</th>\n","      <th>mean</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>Southwest Airlines Co.</td>\n","      <td>39273</td>\n","      <td>0.740050</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>American Airlines Inc.</td>\n","      <td>24853</td>\n","      <td>0.741440</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Delta Air Lines Inc.</td>\n","      <td>23144</td>\n","      <td>0.845705</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>United Air Lines Inc.</td>\n","      <td>19290</td>\n","      <td>0.836288</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>SkyWest Airlines Inc.</td>\n","      <td>18056</td>\n","      <td>0.835567</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>Spirit Air Lines</td>\n","      <td>7058</td>\n","      <td>0.694106</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>Envoy Air</td>\n","      <td>6783</td>\n","      <td>0.783871</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>JetBlue Airways</td>\n","      <td>6588</td>\n","      <td>0.681087</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>Republic Airline</td>\n","      <td>6546</td>\n","      <td>0.908952</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>Alaska Airlines Inc.</td>\n","      <td>6160</td>\n","      <td>0.771266</td>\n","    </tr>\n","    <tr>\n","      <th>10</th>\n","      <td>PSA Airlines Inc.</td>\n","      <td>5306</td>\n","      <td>0.815492</td>\n","    </tr>\n","    <tr>\n","      <th>11</th>\n","      <td>Endeavor Air Inc.</td>\n","      <td>5180</td>\n","      <td>0.861583</td>\n","    </tr>\n","    <tr>\n","      <th>12</th>\n","      <td>Frontier Airlines Inc.</td>\n","      <td>5002</td>\n","      <td>0.750500</td>\n","    </tr>\n","    <tr>\n","      <th>13</th>\n","      <td>Allegiant Air</td>\n","      <td>3333</td>\n","      <td>0.777078</td>\n","    </tr>\n","    <tr>\n","      <th>14</th>\n","      <td>Hawaiian Airlines Inc.</td>\n","      <td>2169</td>\n","      <td>0.750115</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["              airline_name  count      mean\n","0   Southwest Airlines Co.  39273  0.740050\n","1   American Airlines Inc.  24853  0.741440\n","2     Delta Air Lines Inc.  23144  0.845705\n","3    United Air Lines Inc.  19290  0.836288\n","4    SkyWest Airlines Inc.  18056  0.835567\n","5         Spirit Air Lines   7058  0.694106\n","6                Envoy Air   6783  0.783871\n","7          JetBlue Airways   6588  0.681087\n","8         Republic Airline   6546  0.908952\n","9     Alaska Airlines Inc.   6160  0.771266\n","10       PSA Airlines Inc.   5306  0.815492\n","11       Endeavor Air Inc.   5180  0.861583\n","12  Frontier Airlines Inc.   5002  0.750500\n","13           Allegiant Air   3333  0.777078\n","14  Hawaiian Airlines Inc.   2169  0.750115"]},"execution_count":10,"metadata":{},"output_type":"execute_result"}],"source":["g = df.groupby('airline_name')[target].agg(['count', 'mean'])\n","g = g.sort_values(by='count', ascending=False)\n","\n","g = g.reset_index()\n","g"]},{"cell_type":"code","execution_count":11,"id":"204b5883","metadata":{"execution":{"iopub.execute_input":"2025-05-19T01:37:36.182497Z","iopub.status.busy":"2025-05-19T01:37:36.182152Z","iopub.status.idle":"2025-05-19T01:37:36.188425Z","shell.execute_reply":"2025-05-19T01:37:36.18764Z"},"papermill":{"duration":0.014469,"end_time":"2025-05-19T01:37:36.190076","exception":false,"start_time":"2025-05-19T01:37:36.175607","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["['crs_elapsed_time', 'actual_elapsed_time', 'div_actual_elapsed_time']"]},"execution_count":11,"metadata":{},"output_type":"execute_result"}],"source":["[x for x in df.columns if 'elapsed' in x]"]},{"cell_type":"code","execution_count":12,"id":"7fe09433","metadata":{"execution":{"iopub.execute_input":"2025-05-19T01:37:36.200472Z","iopub.status.busy":"2025-05-19T01:37:36.199572Z","iopub.status.idle":"2025-05-19T01:37:36.302309Z","shell.execute_reply":"2025-05-19T01:37:36.301321Z"},"papermill":{"duration":0.109667,"end_time":"2025-05-19T01:37:36.30397","exception":false,"start_time":"2025-05-19T01:37:36.194303","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>std_ls_date</th>\n","      <th>flight_number</th>\n","      <th>tail_num</th>\n","      <th>origin</th>\n","      <th>std_z_date_time</th>\n","      <th>atd_z_date_time</th>\n","      <th>sta_ls_time</th>\n","      <th>ata_ls_time</th>\n","      <th>dep_delay</th>\n","      <th>crs_elapsed_time</th>\n","      <th>dep_delay</th>\n","      <th>dep_delay_new</th>\n","      <th>dep_delay_group</th>\n","      <th>arr_delay</th>\n","      <th>arr_delay_new</th>\n","      <th>arr_delay_group</th>\n","      <th>carrier_delay</th>\n","      <th>weather_delay</th>\n","      <th>nas_delay</th>\n","      <th>security_delay</th>\n","      <th>late_aircraft_delay</th>\n","      <th>div_arr_delay</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>14836</th>\n","      <td>2024-01-01</td>\n","      <td>WN1181</td>\n","      <td>N8579Z</td>\n","      <td>MDW</td>\n","      <td>2024-01-01 14:25:00+00:00</td>\n","      <td>2024-01-01 16:53:00+00:00</td>\n","      <td>1115</td>\n","      <td>1332</td>\n","      <td>148.0</td>\n","      <td>110.0</td>\n","      <td>148.0</td>\n","      <td>148.0</td>\n","      <td>9.0</td>\n","      <td>137.0</td>\n","      <td>137.0</td>\n","      <td>9.0</td>\n","      <td>132.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>5.0</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>14839</th>\n","      <td>2024-01-01</td>\n","      <td>WN0964</td>\n","      <td>N8579Z</td>\n","      <td>TPA</td>\n","      <td>2024-01-01 18:55:00+00:00</td>\n","      <td>2024-01-01 22:14:00+00:00</td>\n","      <td>1640</td>\n","      <td>1956</td>\n","      <td>199.0</td>\n","      <td>165.0</td>\n","      <td>199.0</td>\n","      <td>199.0</td>\n","      <td>12.0</td>\n","      <td>196.0</td>\n","      <td>196.0</td>\n","      <td>12.0</td>\n","      <td>196.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>14837</th>\n","      <td>2024-01-01</td>\n","      <td>WN2178</td>\n","      <td>N8579Z</td>\n","      <td>ALB</td>\n","      <td>2024-01-01 22:30:00+00:00</td>\n","      <td>2024-01-02 01:36:00+00:00</td>\n","      <td>2040</td>\n","      <td>2316</td>\n","      <td>186.0</td>\n","      <td>190.0</td>\n","      <td>186.0</td>\n","      <td>186.0</td>\n","      <td>12.0</td>\n","      <td>156.0</td>\n","      <td>156.0</td>\n","      <td>10.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>156.0</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>14838</th>\n","      <td>2024-01-01</td>\n","      <td>WN2178</td>\n","      <td>N8579Z</td>\n","      <td>MCO</td>\n","      <td>2024-01-02 02:30:00+00:00</td>\n","      <td>2024-01-02 05:11:00+00:00</td>\n","      <td>2220</td>\n","      <td>0052</td>\n","      <td>161.0</td>\n","      <td>110.0</td>\n","      <td>161.0</td>\n","      <td>161.0</td>\n","      <td>10.0</td>\n","      <td>152.0</td>\n","      <td>152.0</td>\n","      <td>10.0</td>\n","      <td>3.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>149.0</td>\n","      <td>NaN</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["      std_ls_date flight_number tail_num origin           std_z_date_time  \\\n","14836  2024-01-01        WN1181   N8579Z    MDW 2024-01-01 14:25:00+00:00   \n","14839  2024-01-01        WN0964   N8579Z    TPA 2024-01-01 18:55:00+00:00   \n","14837  2024-01-01        WN2178   N8579Z    ALB 2024-01-01 22:30:00+00:00   \n","14838  2024-01-01        WN2178   N8579Z    MCO 2024-01-02 02:30:00+00:00   \n","\n","                atd_z_date_time sta_ls_time ata_ls_time  dep_delay  \\\n","14836 2024-01-01 16:53:00+00:00        1115        1332      148.0   \n","14839 2024-01-01 22:14:00+00:00        1640        1956      199.0   \n","14837 2024-01-02 01:36:00+00:00        2040        2316      186.0   \n","14838 2024-01-02 05:11:00+00:00        2220        0052      161.0   \n","\n","       crs_elapsed_time  dep_delay  dep_delay_new  dep_delay_group  arr_delay  \\\n","14836             110.0      148.0          148.0              9.0      137.0   \n","14839             165.0      199.0          199.0             12.0      196.0   \n","14837             190.0      186.0          186.0             12.0      156.0   \n","14838             110.0      161.0          161.0             10.0      152.0   \n","\n","       arr_delay_new  arr_delay_group  carrier_delay  weather_delay  \\\n","14836          137.0              9.0          132.0            0.0   \n","14839          196.0             12.0          196.0            0.0   \n","14837          156.0             10.0            0.0            0.0   \n","14838          152.0             10.0            3.0            0.0   \n","\n","       nas_delay  security_delay  late_aircraft_delay  div_arr_delay  \n","14836        0.0             0.0                  5.0            NaN  \n","14839        0.0             0.0                  0.0            NaN  \n","14837        0.0             0.0                156.0            NaN  \n","14838        0.0             0.0                149.0            NaN  "]},"execution_count":12,"metadata":{},"output_type":"execute_result"}],"source":["g = df.query('\"2024-01-01\" <= std_ls_date <= \"2024-01-01\"')\n","g = g.query('airline_name == \"Southwest Airlines Co.\"')\n","g = g.query('tail_num == \"N8579Z\"')\n","g = g.sort_values(by='std_ls_date_time')\n","col = ['std_ls_date', 'flight_number', 'tail_num'\n","       , 'origin'\n","       , 'std_z_date_time'\n","       , 'atd_z_date_time'\n","       , 'sta_ls_time'\n","       , 'ata_ls_time'\n","       , 'dep_delay'\n","       , 'crs_elapsed_time'\n","      ] + [x for x in df.columns if 'delay' in x]\n","g[col]\n"]},{"cell_type":"code","execution_count":13,"id":"07d238ce","metadata":{"execution":{"iopub.execute_input":"2025-05-19T01:37:36.314943Z","iopub.status.busy":"2025-05-19T01:37:36.314565Z","iopub.status.idle":"2025-05-19T01:37:36.321069Z","shell.execute_reply":"2025-05-19T01:37:36.320282Z"},"papermill":{"duration":0.013671,"end_time":"2025-05-19T01:37:36.322587","exception":false,"start_time":"2025-05-19T01:37:36.308916","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["['dep_delay',\n"," 'dep_delay_new',\n"," 'dep_delay_group',\n"," 'arr_delay',\n"," 'arr_delay_new',\n"," 'arr_delay_group',\n"," 'carrier_delay',\n"," 'weather_delay',\n"," 'nas_delay',\n"," 'security_delay',\n"," 'late_aircraft_delay',\n"," 'div_arr_delay']"]},"execution_count":13,"metadata":{},"output_type":"execute_result"}],"source":["[x for x in df.columns if 'delay' in x]"]},{"cell_type":"code","execution_count":null,"id":"f02b0594","metadata":{"papermill":{"duration":0.004238,"end_time":"2025-05-19T01:37:36.331431","exception":false,"start_time":"2025-05-19T01:37:36.327193","status":"completed"},"tags":[]},"outputs":[],"source":[]}],"metadata":{"kaggle":{"accelerator":"none","dataSources":[{"datasetId":7402244,"sourceId":11853003,"sourceType":"datasetVersion"}],"dockerImageVersionId":31040,"isGpuEnabled":false,"isInternetEnabled":true,"language":"python","sourceType":"notebook"},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.11.11"},"papermill":{"default_parameters":{},"duration":169.61445,"end_time":"2025-05-19T01:37:37.259307","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2025-05-19T01:34:47.644857","version":"2.6.0"}},"nbformat":4,"nbformat_minor":5}